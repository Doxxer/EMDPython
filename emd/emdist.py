from math import sqrt
import time

__author__ = 'doxer'

from emd import emd


def emdist(a, b, distance_function):
    """
    Return Earth Mover's distance

    :type distance_function: function
    :type b: numpy matrix
    :type a: numpy matrix
    """
    w1, w2 = a[:, 0], b[:, 0]
    feature1, feature2 = a[:, 1:], b[:, 1:]
    feature1 = (feature1.tolist(), w1.tolist())
    feature2 = (feature2.tolist(), w2.tolist())

    return emd(feature1, feature2, distance_function)


if __name__ == "__main__":
    def d(x, y):
        return sqrt((x[0] - y[0]) ** 2 + (x[1] - y[1]) ** 2) + 100 * abs(x[2] - y[2]) ** 3

    feature1 = ([[0.05, 0.9923175416133163, 0.0], [0.07727272727272727, 1.0, 0.008849557522123894],
                 [0.08863636363636364, 1.0, 0.017699115044247787],
                 [0.09090909090909091, 0.9884763124199744, 0.02654867256637168],
                 [0.09090909090909091, 0.9551856594110115, 0.035398230088495575],
                 [0.056818181818181816, 0.9039692701664532, 0.04424778761061947],
                 [0.029545454545454545, 0.8668373879641486, 0.05309734513274336],
                 [0.00909090909090909, 0.8297055057618438, 0.061946902654867256],
                 [0.0, 0.8079385403329066, 0.07079646017699115], [0.0, 0.7912932138284251, 0.07964601769911504],
                 [0.0, 0.7810499359795134, 0.08849557522123894],
                 [0.031818181818181815, 0.7746478873239436, 0.09734513274336283],
                 [0.08863636363636364, 0.7733674775928298, 0.10619469026548672],
                 [0.1431818181818182, 0.7733674775928298, 0.11504424778761062],
                 [0.175, 0.7720870678617158, 0.12389380530973451],
                 [0.19090909090909092, 0.7669654289372599, 0.13274336283185842],
                 [0.20227272727272727, 0.7541613316261203, 0.1415929203539823],
                 [0.2, 0.7272727272727273, 0.1504424778761062],
                 [0.17045454545454544, 0.6939820742637645, 0.1592920353982301],
                 [0.1431818181818182, 0.6606914212548015, 0.168141592920354],
                 [0.12727272727272726, 0.6402048655569782, 0.17699115044247787],
                 [0.12272727272727273, 0.6274007682458387, 0.18584070796460178],
                 [0.12272727272727273, 0.6197183098591549, 0.19469026548672566],
                 [0.12272727272727273, 0.6133162612035852, 0.20353982300884957],
                 [0.13636363636363635, 0.6107554417413572, 0.21238938053097345],
                 [0.16136363636363638, 0.6094750320102432, 0.22123893805309736],
                 [0.18181818181818182, 0.6069142125480154, 0.23008849557522124],
                 [0.19318181818181818, 0.5966709346991037, 0.23893805309734514],
                 [0.19545454545454546, 0.5749039692701664, 0.24778761061946902],
                 [0.19090909090909092, 0.5313700384122919, 0.25663716814159293],
                 [0.16363636363636364, 0.4878361075544174, 0.26548672566371684],
                 [0.1409090909090909, 0.4494238156209987, 0.2743362831858407],
                 [0.12727272727272726, 0.4212548015364917, 0.2831858407079646],
                 [0.12727272727272726, 0.3994878361075544, 0.2920353982300885],
                 [0.12727272727272726, 0.38156209987195905, 0.3008849557522124],
                 [0.15, 0.3725992317541613, 0.30973451327433627], [0.2, 0.3713188220230474, 0.3185840707964602],
                 [0.2545454545454545, 0.3713188220230474, 0.3274336283185841],
                 [0.28863636363636364, 0.3700384122919334, 0.336283185840708],
                 [0.31363636363636366, 0.3649167733674776, 0.34513274336283184],
                 [0.3340909090909091, 0.35723431498079383, 0.35398230088495575],
                 [0.3477272727272727, 0.34314980793854033, 0.36283185840707965],
                 [0.3477272727272727, 0.31498079385403327, 0.37168141592920356],
                 [0.3386363636363636, 0.2752880921895006, 0.3805309734513274],
                 [0.3068181818181818, 0.22919334186939821, 0.3893805309734513],
                 [0.2840909090909091, 0.19590268886043533, 0.39823008849557523],
                 [0.2727272727272727, 0.17541613316261204, 0.40707964601769914],
                 [0.27045454545454545, 0.16261203585147246, 0.415929203539823],
                 [0.27045454545454545, 0.15620998719590268, 0.4247787610619469],
                 [0.27045454545454545, 0.15108834827144688, 0.4336283185840708],
                 [0.2818181818181818, 0.14980793854033292, 0.4424778761061947],
                 [0.3, 0.14852752880921896, 0.45132743362831856],
                 [0.31363636363636366, 0.14596670934699105, 0.46017699115044247],
                 [0.3159090909090909, 0.13700384122919335, 0.4690265486725664],
                 [0.3159090909090909, 0.11651728553137004, 0.4778761061946903],
                 [0.30454545454545456, 0.08578745198463508, 0.48672566371681414],
                 [0.2909090909090909, 0.0678617157490397, 0.49557522123893805],
                 [0.2818181818181818, 0.05761843790012804, 0.504424778761062],
                 [0.2818181818181818, 0.052496798975672214, 0.5132743362831859],
                 [0.6772727272727272, 0.9807938540332907, 0.5221238938053098],
                 [0.7, 0.9948783610755442, 0.5309734513274337],
                 [0.7318181818181818, 0.9948783610755442, 0.5398230088495575],
                 [0.7681818181818182, 0.9948783610755442, 0.5486725663716814],
                 [0.7863636363636364, 0.9910371318822023, 0.5575221238938053],
                 [0.7909090909090909, 0.9641485275288092, 0.5663716814159292],
                 [0.775, 0.9206145966709347, 0.5752212389380531],
                 [0.7318181818181818, 0.8745198463508322, 0.584070796460177],
                 [0.6931818181818182, 0.8322663252240717, 0.5929203539823009],
                 [0.6681818181818182, 0.8053777208706786, 0.6017699115044248],
                 [0.6590909090909091, 0.7861715749039693, 0.6106194690265486],
                 [0.6545454545454545, 0.7733674775928298, 0.6194690265486725],
                 [0.6545454545454545, 0.765685019206146, 0.6283185840707964],
                 [0.6568181818181819, 0.7605633802816901, 0.6371681415929203],
                 [0.6931818181818182, 0.7592829705505761, 0.6460176991150443],
                 [0.7295454545454545, 0.7554417413572343, 0.6548672566371682],
                 [0.7568181818181818, 0.7490396927016645, 0.6637168141592921],
                 [0.7659090909090909, 0.7400768245838668, 0.672566371681416],
                 [0.7659090909090909, 0.7157490396927016, 0.6814159292035398],
                 [0.7386363636363636, 0.676056338028169, 0.6902654867256637],
                 [0.6954545454545454, 0.6363636363636364, 0.6991150442477876],
                 [0.675, 0.6069142125480154, 0.7079646017699115],
                 [0.6727272727272727, 0.5838668373879642, 0.7168141592920354],
                 [0.6727272727272727, 0.5646606914212549, 0.7256637168141593],
                 [0.7113636363636363, 0.5531370038412292, 0.7345132743362832],
                 [0.7636363636363637, 0.5492957746478874, 0.7433628318584071],
                 [0.8022727272727272, 0.5428937259923176, 0.7522123893805309],
                 [0.8363636363636363, 0.5364916773367477, 0.7610619469026548],
                 [0.85, 0.528809218950064, 0.7699115044247787],
                 [0.8568181818181818, 0.5147247119078106, 0.7787610619469026],
                 [0.8477272727272728, 0.4839948783610755, 0.7876106194690266],
                 [0.8068181818181818, 0.44302176696542894, 0.7964601769911505],
                 [0.7863636363636364, 0.41229193341869397, 0.8053097345132744],
                 [0.7795454545454545, 0.38156209987195905, 0.8141592920353983],
                 [0.7795454545454545, 0.353393085787452, 0.8230088495575221],
                 [0.7795454545454545, 0.33674775928297057, 0.831858407079646],
                 [0.7977272727272727, 0.322663252240717, 0.8407079646017699],
                 [0.8295454545454546, 0.31370038412291934, 0.8495575221238938],
                 [0.8545454545454545, 0.3034571062740077, 0.8584070796460177],
                 [0.8704545454545455, 0.29577464788732394, 0.8672566371681416],
                 [0.8795454545454545, 0.28425096030729835, 0.8761061946902655],
                 [0.8795454545454545, 0.26632522407170295, 0.8849557522123894],
                 [0.8704545454545455, 0.2407170294494238, 0.8938053097345132],
                 [0.8545454545454545, 0.22151088348271447, 0.9026548672566371],
                 [0.8454545454545455, 0.20486555697823303, 0.911504424778761],
                 [0.8454545454545455, 0.18693982074263765, 0.9203539823008849],
                 [0.8454545454545455, 0.1702944942381562, 0.9292035398230089],
                 [0.8727272727272727, 0.15492957746478872, 0.9380530973451328],
                 [0.9318181818181818, 0.13956466069142126, 0.9469026548672567],
                 [0.9772727272727273, 0.12804097311139565, 0.9557522123893806],
                 [0.9931818181818182, 0.11395646606914213, 0.9646017699115044],
                 [1.0, 0.09346991037131883, 0.9734513274336283],
                 [0.9659090909090909, 0.058898847631242, 0.9823008849557522],
                 [0.9136363636363637, 0.026888604353393086, 0.9911504424778761], [0.8795454545454545, 0.0, 1.0]],
                [0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403, 0.008771929824561403, 0.008771929824561403,
                 0.008771929824561403, 0.008771929824561403])
    feature2 = ([[0.3068362480127186, 0.7470967741935484, 0.01639344262295082],
                 [0.3179650238473768, 0.743225806451613, 0.03278688524590164],
                 [0.3275039745627981, 0.743225806451613, 0.04918032786885246],
                 [0.34181240063593005, 0.743225806451613, 0.06557377049180328],
                 [0.35930047694753575, 0.743225806451613, 0.08196721311475409],
                 [0.3767885532591415, 0.743225806451613, 0.09836065573770492],
                 [0.40222575516693165, 0.743225806451613, 0.11475409836065574],
                 [0.4276629570747218, 0.743225806451613, 0.13114754098360656],
                 [0.4594594594594595, 0.743225806451613, 0.14754098360655737],
                 [0.4944356120826709, 0.743225806451613, 0.16393442622950818],
                 [0.5310015898251192, 0.743225806451613, 0.18032786885245902],
                 [0.5691573926868044, 0.743225806451613, 0.19672131147540983],
                 [0.6089030206677265, 0.743225806451613, 0.21311475409836064],
                 [0.6486486486486487, 0.743225806451613, 0.22950819672131148],
                 [0.6883942766295708, 0.743225806451613, 0.2459016393442623],
                 [0.724960254372019, 0.7445161290322581, 0.26229508196721313],
                 [0.7551669316375199, 0.7458064516129033, 0.2786885245901639],
                 [0.7933227344992051, 0.7483870967741936, 0.29508196721311475],
                 [0.8282988871224165, 0.7496774193548387, 0.3114754098360656],
                 [0.8600953895071543, 0.7535483870967742, 0.32786885245901637],
                 [0.8855325914149443, 0.7548387096774194, 0.3442622950819672],
                 [0.9300476947535771, 0.76, 0.36065573770491804],
                 [0.9634340222575517, 0.7638709677419355, 0.3770491803278688],
                 [0.9825119236883942, 0.7651612903225806, 0.39344262295081966],
                 [0.9936406995230525, 0.7664516129032258, 0.4098360655737705],
                 [1.0, 0.7664516129032258, 0.4262295081967213], [0.0, 0.4464516129032258, 0.00546448087431694],
                 [0.0047694753577106515, 0.44516129032258067, 0.01639344262295082],
                 [0.017488076311605722, 0.44387096774193546, 0.03278688524590164],
                 [0.02702702702702703, 0.44516129032258067, 0.04918032786885246],
                 [0.04292527821939587, 0.44516129032258067, 0.06557377049180328],
                 [0.06518282988871224, 0.44516129032258067, 0.08196721311475409],
                 [0.08744038155802862, 0.44516129032258067, 0.09836065573770492],
                 [0.10969793322734499, 0.4464516129032258, 0.11475409836065574],
                 [0.13513513513513514, 0.447741935483871, 0.13114754098360656],
                 [0.17011128775834658, 0.45161290322580644, 0.14754098360655737],
                 [0.20190779014308427, 0.45548387096774196, 0.16393442622950818],
                 [0.2368839427662957, 0.45806451612903226, 0.18032786885245902],
                 [0.28298887122416533, 0.46580645161290324, 0.19672131147540983],
                 [0.3163751987281399, 0.4696774193548387, 0.21311475409836064],
                 [0.35453100158982515, 0.47483870967741937, 0.22950819672131148],
                 [0.3942766295707472, 0.4774193548387097, 0.2459016393442623],
                 [0.4292527821939587, 0.48129032258064514, 0.26229508196721313],
                 [0.46740858505564387, 0.4864516129032258, 0.2786885245901639],
                 [0.505564387917329, 0.49032258064516127, 0.29508196721311475],
                 [0.5421303656597775, 0.4941935483870968, 0.3114754098360656],
                 [0.5802861685214626, 0.4993548387096774, 0.32786885245901637],
                 [0.6136724960254372, 0.5019354838709678, 0.3442622950819672],
                 [0.6406995230524642, 0.5058064516129033, 0.36065573770491804],
                 [0.6740858505564388, 0.5083870967741936, 0.3770491803278688],
                 [0.7011128775834659, 0.5109677419354839, 0.39344262295081966],
                 [0.7313195548489666, 0.5135483870967742, 0.4098360655737705],
                 [0.7615262321144675, 0.5161290322580645, 0.4262295081967213],
                 [0.8060413354531002, 0.5174193548387097, 0.4426229508196721],
                 [0.8664546899841018, 0.5174193548387097, 0.453551912568306],
                 [0.0047694753577106515, 0.12387096774193548, 0.0],
                 [0.011128775834658187, 0.12774193548387097, 0.00546448087431694],
                 [0.012718600953895072, 0.12774193548387097, 0.01639344262295082],
                 [0.02066772655007949, 0.13032258064516128, 0.03278688524590164],
                 [0.030206677265500796, 0.13032258064516128, 0.04918032786885246],
                 [0.046104928457869634, 0.13032258064516128, 0.06557377049180328],
                 [0.06677265500794913, 0.13032258064516128, 0.08196721311475409],
                 [0.0890302066772655, 0.1329032258064516, 0.09836065573770492],
                 [0.10810810810810811, 0.13419354838709677, 0.11475409836065574],
                 [0.13513513513513514, 0.1367741935483871, 0.13114754098360656],
                 [0.1685214626391097, 0.1432258064516129, 0.14754098360655737],
                 [0.1987281399046105, 0.14580645161290323, 0.16393442622950818],
                 [0.23052464228934816, 0.14967741935483872, 0.18032786885245902],
                 [0.27344992050874406, 0.15870967741935485, 0.19672131147540983],
                 [0.3068362480127186, 0.1625806451612903, 0.21311475409836064],
                 [0.34181240063593005, 0.16774193548387098, 0.22950819672131148],
                 [0.3799682034976153, 0.17290322580645162, 0.2459016393442623],
                 [0.41812400635930047, 0.17548387096774193, 0.26229508196721313],
                 [0.4546899841017488, 0.18064516129032257, 0.2786885245901639],
                 [0.4912559618441971, 0.18580645161290324, 0.29508196721311475],
                 [0.5262321144674086, 0.1896774193548387, 0.3114754098360656],
                 [0.5580286168521462, 0.1935483870967742, 0.32786885245901637],
                 [0.5945945945945946, 0.19741935483870968, 0.3442622950819672],
                 [0.6263910969793323, 0.20129032258064516, 0.36065573770491804],
                 [0.6550079491255962, 0.20387096774193547, 0.3770491803278688],
                 [0.6820349761526232, 0.2064516129032258, 0.39344262295081966],
                 [0.7106518282988871, 0.20774193548387096, 0.4098360655737705],
                 [0.7376788553259142, 0.2103225806451613, 0.4262295081967213],
                 [0.766295707472178, 0.21161290322580645, 0.4426229508196721],
                 [0.8028616852146264, 0.2167741935483871, 0.453551912568306],
                 [0.1891891891891892, 0.8735483870967742, 0.46994535519125685],
                 [0.1875993640699523, 0.8735483870967742, 0.47540983606557374],
                 [0.18441971383147854, 0.8658064516129033, 0.4918032786885246],
                 [0.18282988871224165, 0.863225806451613, 0.5081967213114754],
                 [0.18124006359300476, 0.8516129032258064, 0.5245901639344263],
                 [0.18124006359300476, 0.8374193548387097, 0.5409836065573771],
                 [0.18124006359300476, 0.8206451612903226, 0.5573770491803278],
                 [0.18124006359300476, 0.8, 0.5737704918032787],
                 [0.18124006359300476, 0.7729032258064517, 0.5901639344262295],
                 [0.18124006359300476, 0.7419354838709677, 0.6065573770491803],
                 [0.18282988871224165, 0.6980645161290323, 0.6229508196721312],
                 [0.18441971383147854, 0.6529032258064517, 0.639344262295082],
                 [0.18600953895071543, 0.6064516129032258, 0.6557377049180327],
                 [0.19236883942766295, 0.5625806451612904, 0.6721311475409836],
                 [0.1971383147853736, 0.5187096774193548, 0.6885245901639344],
                 [0.20190779014308427, 0.47870967741935483, 0.7049180327868853],
                 [0.2066772655007949, 0.43612903225806454, 0.7213114754098361],
                 [0.21144674085850557, 0.3961290322580645, 0.7377049180327869],
                 [0.21621621621621623, 0.3574193548387097, 0.7540983606557377],
                 [0.21939586645468998, 0.32387096774193547, 0.7704918032786885],
                 [0.22257551669316375, 0.28903225806451616, 0.7868852459016393],
                 [0.22575516693163752, 0.2541935483870968, 0.8032786885245902],
                 [0.2289348171701113, 0.21935483870967742, 0.819672131147541],
                 [0.23052464228934816, 0.1870967741935484, 0.8360655737704918],
                 [0.23370429252782193, 0.15870967741935485, 0.8524590163934426],
                 [0.23529411764705882, 0.13419354838709677, 0.8688524590163934],
                 [0.23529411764705882, 0.11225806451612903, 0.8852459016393442],
                 [0.23529411764705882, 0.09548387096774194, 0.9016393442622951],
                 [0.2368839427662957, 0.07741935483870968, 0.9180327868852459],
                 [0.2368839427662957, 0.06193548387096774, 0.9344262295081968],
                 [0.2368839427662957, 0.04645161290322581, 0.9508196721311475],
                 [0.2368839427662957, 0.02838709677419355, 0.9672131147540983],
                 [0.2384737678855326, 0.0, 0.9836065573770492],
                 [0.5707472178060413, 0.9367741935483871, 0.47540983606557374],
                 [0.5691573926868044, 0.927741935483871, 0.4918032786885246],
                 [0.5691573926868044, 0.92, 0.5081967213114754],
                 [0.5691573926868044, 0.9109677419354839, 0.5245901639344263],
                 [0.5691573926868044, 0.8993548387096775, 0.5409836065573771],
                 [0.5691573926868044, 0.8812903225806452, 0.5573770491803278],
                 [0.5691573926868044, 0.8606451612903225, 0.5737704918032787],
                 [0.5691573926868044, 0.8309677419354838, 0.5901639344262295],
                 [0.5691573926868044, 0.7974193548387096, 0.6065573770491803],
                 [0.5691573926868044, 0.7561290322580645, 0.6229508196721312],
                 [0.5691573926868044, 0.712258064516129, 0.639344262295082],
                 [0.575516693163752, 0.6709677419354839, 0.6557377049180327],
                 [0.5786963434022258, 0.6374193548387097, 0.6721311475409836],
                 [0.5834658187599364, 0.5935483870967742, 0.6885245901639344],
                 [0.5850556438791733, 0.5548387096774193, 0.7049180327868853],
                 [0.5866454689984102, 0.5109677419354839, 0.7213114754098361],
                 [0.589825119236884, 0.47096774193548385, 0.7377049180327869],
                 [0.5914149443561209, 0.43870967741935485, 0.7540983606557377],
                 [0.5961844197138315, 0.40258064516129033, 0.7704918032786885],
                 [0.5977742448330684, 0.37032258064516127, 0.7868852459016393],
                 [0.6009538950715422, 0.3393548387096774, 0.8032786885245902],
                 [0.6025437201907791, 0.30709677419354836, 0.819672131147541],
                 [0.604133545310016, 0.2761290322580645, 0.8360655737704918],
                 [0.6057233704292527, 0.24774193548387097, 0.8524590163934426],
                 [0.6073131955484896, 0.21806451612903227, 0.8688524590163934],
                 [0.6073131955484896, 0.19741935483870968, 0.8852459016393442],
                 [0.6089030206677265, 0.17935483870967742, 0.9016393442622951],
                 [0.6104928457869634, 0.16129032258064516, 0.9180327868852459],
                 [0.6104928457869634, 0.14451612903225808, 0.9344262295081968],
                 [0.6104928457869634, 0.12903225806451613, 0.9508196721311475],
                 [0.6120826709062003, 0.11612903225806452, 0.9672131147540983],
                 [0.6120826709062003, 0.0967741935483871, 0.9836065573770492],
                 [0.9443561208267091, 1.0, 0.4644808743169399],
                 [0.9443561208267091, 0.9961290322580645, 0.47540983606557374],
                 [0.9443561208267091, 0.9870967741935484, 0.4918032786885246],
                 [0.9443561208267091, 0.9780645161290322, 0.5081967213114754],
                 [0.9443561208267091, 0.9651612903225807, 0.5245901639344263],
                 [0.9443561208267091, 0.9483870967741935, 0.5409836065573771],
                 [0.9459459459459459, 0.9264516129032258, 0.5573770491803278],
                 [0.9475357710651828, 0.8980645161290323, 0.5737704918032787],
                 [0.9538950715421304, 0.8593548387096774, 0.5901639344262295],
                 [0.9570747217806042, 0.8180645161290323, 0.6065573770491803],
                 [0.9602543720190779, 0.7716129032258064, 0.6229508196721312],
                 [0.9618441971383148, 0.7251612903225807, 0.639344262295082],
                 [0.9682034976152624, 0.68, 0.6557377049180327],
                 [0.9697933227344993, 0.6438709677419355, 0.6721311475409836],
                 [0.972972972972973, 0.6051612903225806, 0.6885245901639344],
                 [0.9761526232114467, 0.5638709677419355, 0.7049180327868853],
                 [0.9793322734499205, 0.5251612903225806, 0.7213114754098361],
                 [0.9809220985691574, 0.4916129032258065, 0.7377049180327869],
                 [0.9825119236883942, 0.4541935483870968, 0.7540983606557377],
                 [0.9841017488076311, 0.41935483870967744, 0.7704918032786885],
                 [0.985691573926868, 0.38838709677419353, 0.7868852459016393],
                 [0.9872813990461049, 0.35870967741935483, 0.8032786885245902],
                 [0.9872813990461049, 0.327741935483871, 0.819672131147541],
                 [0.9872813990461049, 0.2967741935483871, 0.8360655737704918],
                 [0.9872813990461049, 0.2645161290322581, 0.8524590163934426],
                 [0.9872813990461049, 0.24258064516129033, 0.8688524590163934],
                 [0.9872813990461049, 0.22193548387096773, 0.8852459016393442],
                 [0.9872813990461049, 0.20258064516129032, 0.9016393442622951],
                 [0.9872813990461049, 0.1870967741935484, 0.9180327868852459],
                 [0.9872813990461049, 0.17419354838709677, 0.9344262295081968],
                 [0.9872813990461049, 0.1638709677419355, 0.9508196721311475],
                 [0.9872813990461049, 0.15612903225806452, 0.9672131147540983],
                 [0.9872813990461049, 0.14838709677419354, 0.9836065573770492],
                 [0.9872813990461049, 0.12387096774193548, 1.0]],
                [0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652,
                 0.005434782608695652, 0.005434782608695652, 0.005434782608695652, 0.005434782608695652])

    st = time.time()
    print emd(feature1, feature2, d)
    print (time.time() - st) * 1000